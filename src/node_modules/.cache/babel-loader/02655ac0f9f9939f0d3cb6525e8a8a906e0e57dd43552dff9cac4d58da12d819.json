{"ast":null,"code":"var _jsxFileName = \"D:\\\\ad\\\\Adminka\\\\src\\\\components\\\\pages\\\\Access\\\\PasswordField\\\\PasswordField.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback } from 'react';\nimport axios from 'axios';\nimport { setToken } from 'features/access/tokenSlice';\nimport { useAppDispatch } from 'App';\nimport { Input, EnterPass, VerifPass, PasswordFieldWrapper, NotVerifPass } from './PasswordField.styled';\nimport { Button } from '../Button';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst userResponse = {\n  \"status\": \"success\",\n  \"code\": 200,\n  \"user\": {\n    \"_id\": \"6536cb40578c40e354fad54d\",\n    \"access\": [\"Statistics and access to cabinets\"],\n    \"status\": \"active\",\n    \"role\": \"admin\",\n    \"token\": \"your-token-here\"\n  }\n};\nexport const PasswordField = _ref => {\n  _s();\n  let {\n    setIsSend,\n    email\n  } = _ref;\n  const [passwordCode, setPasswordCode] = useState('');\n  const [messagePass, setMessagePass] = useState();\n  const dispatch = useAppDispatch();\n  const user = userResponse.user;\n  const availableSections = {\n    \"Statistics and access to cabinets\": true\n  };\n  const validPassword = useCallback(async () => {\n    try {\n      const response = await axios.post('https://server-your-price-booking.onrender.com/api/acsess-to-admin/log-in-admin/', {\n        email,\n        secretCode: passwordCode\n      });\n      const {\n        status,\n        data\n      } = response.data;\n      if (status === 'success') {\n        if (data.role === 'super admin') {\n          dispatch(setToken(data.token));\n          setIsSend(true);\n        } else if (user.role === \"admin\") {\n          const userAccess = user.access;\n          if (userAccess && userAccess.length > 0) {\n            userAccess.forEach(section => {\n              if (availableSections[section]) {\n                console.log(`Admin has access to ${section}`);\n              } else {\n                console.log(`Admin does not have access to ${section}`);\n              }\n            });\n          } else {\n            console.log(\"Admin has no specific access\");\n          }\n        }\n      } else {\n        setMessagePass('You entered a wrong verification code, try again');\n      }\n    } catch (error) {\n      console.error('Error during secret code verification', error);\n    }\n  }, [dispatch, email, passwordCode, setIsSend]);\n  const handleVerificationCodeChange = e => {\n    setPasswordCode(e.target.value);\n  };\n  const handlePasswordSubmit = async e => {\n    e.preventDefault();\n    try {\n      await validPassword();\n    } catch (error) {\n      console.error('Error during password validation', error);\n    }\n  };\n  const handleKeyUp = useCallback(async e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      await validPassword();\n    }\n  }, [validPassword]);\n  return /*#__PURE__*/_jsxDEV(PasswordFieldWrapper, {\n    children: [messagePass ? /*#__PURE__*/_jsxDEV(NotVerifPass, {\n      children: messagePass\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(EnterPass, {\n      children: \"Enter the verification code we sent to your email address\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handlePasswordSubmit,\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        type: \"text\",\n        name: \"verificationCode\",\n        value: passwordCode,\n        onChange: handleVerificationCodeChange,\n        required: true,\n        onKeyDown: handleKeyUp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(VerifPass, {\n      children: \"Verification code - valid for 3 minutes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n_s(PasswordField, \"HIyGJDbVoYHGiii522sIrs3BIlA=\", false, function () {\n  return [useAppDispatch];\n});\n_c = PasswordField;\nvar _c;\n$RefreshReg$(_c, \"PasswordField\");","map":{"version":3,"names":["React","useState","useCallback","axios","setToken","useAppDispatch","Input","EnterPass","VerifPass","PasswordFieldWrapper","NotVerifPass","Button","jsxDEV","_jsxDEV","userResponse","PasswordField","_ref","_s","setIsSend","email","passwordCode","setPasswordCode","messagePass","setMessagePass","dispatch","user","availableSections","validPassword","response","post","secretCode","status","data","role","token","userAccess","access","length","forEach","section","console","log","error","handleVerificationCodeChange","e","target","value","handlePasswordSubmit","preventDefault","handleKeyUp","key","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","onChange","required","onKeyDown","_c","$RefreshReg$"],"sources":["D:/ad/Adminka/src/components/pages/Access/PasswordField/PasswordField.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport axios from 'axios';\nimport { setToken } from 'features/access/tokenSlice';\nimport { useAppDispatch } from 'App';\nimport {\n  Input,\n  EnterPass,\n  VerifPass,\n  PasswordFieldWrapper,\n  NotVerifPass,\n} from './PasswordField.styled';\nimport { Button } from '../Button';\n\nconst userResponse = {\n  \"status\": \"success\",\n  \"code\": 200,\n  \"user\": {\n    \"_id\": \"6536cb40578c40e354fad54d\",\n    \"access\": [\n      \"Statistics and access to cabinets\"\n    ],\n    \"status\": \"active\",\n    \"role\": \"admin\",\n    \"token\": \"your-token-here\"\n  }\n};\nexport const PasswordField: React.FC<{\n  setIsSend: React.Dispatch<React.SetStateAction<boolean>>;\n  email: string;\n}> = ({ setIsSend, email }) => {\n  const [passwordCode, setPasswordCode] = useState<string>('');\n  const [messagePass, setMessagePass] = useState<string>();\n  const dispatch = useAppDispatch();\n  const user = userResponse.user;\n  const availableSections = {\n    \"Statistics and access to cabinets\": true,\n  };\n  const validPassword = useCallback(async () => {\n    try {\n      const response = await axios.post(\n        'https://server-your-price-booking.onrender.com/api/acsess-to-admin/log-in-admin/',\n        {\n          email,\n          secretCode: passwordCode,\n        }\n      );\n\n      const { status, data } = response.data;\n      if (status === 'success') {\n        if (data.role === 'super admin') {\n          dispatch(setToken(data.token as string | null));\n          setIsSend(true);\n        } else if (user.role === \"admin\") {\n          const userAccess = user.access;\n          if (userAccess && userAccess.length > 0) {\n            userAccess.forEach((section) => {\n              if (availableSections[section]) {\n                console.log(`Admin has access to ${section}`);\n              } else {\n                console.log(`Admin does not have access to ${section}`);\n              }\n            });\n          } else {\n            console.log(\"Admin has no specific access\");\n          }\n        }\n        \n      } else {\n        setMessagePass('You entered a wrong verification code, try again');\n      }\n    } catch (error) {\n      console.error('Error during secret code verification', error);\n    }\n  }, [dispatch, email, passwordCode, setIsSend]);\n\n  const handleVerificationCodeChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setPasswordCode(e.target.value);\n  };\n\n  const handlePasswordSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    try {\n      await validPassword();\n    } catch (error) {\n      console.error('Error during password validation', error);\n    }\n  };\n\n  const handleKeyUp = useCallback(async (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      await validPassword();\n    }\n  }, [validPassword]);\n\n  return (\n    <PasswordFieldWrapper>\n      {messagePass ? (\n        <NotVerifPass>{messagePass}</NotVerifPass>\n      ) : (\n        <EnterPass>Enter the verification code we sent to your email address</EnterPass>\n      )}\n      <form onSubmit={handlePasswordSubmit}>\n        <Input\n          type=\"text\"\n          name=\"verificationCode\"\n          value={passwordCode}\n          onChange={handleVerificationCodeChange}\n          required\n          onKeyDown={handleKeyUp}\n        />\n        <Button />\n      </form>\n      <VerifPass>Verification code - valid for 3 minutes</VerifPass>\n    </PasswordFieldWrapper>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}