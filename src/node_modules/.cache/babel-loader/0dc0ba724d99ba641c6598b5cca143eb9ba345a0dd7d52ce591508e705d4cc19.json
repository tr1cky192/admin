{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { baseUrl, endpoints } from 'features/api';\nimport axios from 'axios';\nexport const fetchHoteliers = createAsyncThunk('hoteliers/fetchAllHoteliers', async (_, _ref) => {\n  let {\n    rejectWithValue,\n    getState\n  } = _ref;\n  try {\n    const authToken = getState();\n    const response = await axios.get(`${baseUrl}/acsess-to-admin${endpoints.hoteliers}`, {\n      headers: {\n        'Content-Type': 'application/json; charset=UTF-8',\n        // eslint-disable-next-line\n        Authorization: `Bearer ${authToken.enterToken.token}`\n      },\n      withCredentials: true\n    });\n    const data = response.data;\n    const uniqueOwners = new Set();\n    const hoteliers = [];\n    data.data.result.forEach(_ref2 => {\n      let {\n        finances,\n        status,\n        yourObjects,\n        _id\n      } = _ref2;\n      if (_id && !uniqueOwners.has(_id)) {\n        uniqueOwners.add(_id);\n        hoteliers.push({\n          _id,\n          status,\n          finances,\n          yourObjects\n        });\n      }\n    });\n    return hoteliers;\n  } catch (error) {\n    return rejectWithValue(error);\n  }\n});\nexport const fetchHotelsById = createAsyncThunk('hoteliers/fetchHotelsById', async (id, _ref3) => {\n  let {\n    rejectWithValue\n  } = _ref3;\n  try {\n    const response = await fetch(`${baseUrl + endpoints.hotels}/get-hotels-by-id-hotelier/${id}`, {\n      credentials: 'include'\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch hotels');\n    }\n    const data = await response.json();\n    const hotelsByHotelier = data.data.result.map(_ref4 => {\n      let {\n        objectName\n      } = _ref4;\n      return objectName;\n    });\n    return {\n      ownerId: id,\n      hotels: hotelsByHotelier\n    };\n  } catch (error) {\n    return rejectWithValue(error);\n  }\n});\nexport const fetchBonus = createAsyncThunk('hoteliers/fetchBonus', async (bonusData, _ref5) => {\n  let {\n    rejectWithValue,\n    getState\n  } = _ref5;\n  try {\n    const authToken = getState();\n    const response = await axios.patch(`${baseUrl}/acsess-to-admin${endpoints.bonus}`, bonusData, {\n      headers: {\n        'Content-Type': 'application/json; charset=UTF-8',\n        // eslint-disable-next-line\n        Authorization: `Bearer ${authToken.enterToken.token}`\n      },\n      withCredentials: true\n    });\n    const data = response.data;\n    return data;\n  } catch (error) {\n    return rejectWithValue(error);\n  }\n});","map":{"version":3,"names":["createAsyncThunk","baseUrl","endpoints","axios","fetchHoteliers","_","_ref","rejectWithValue","getState","authToken","response","get","hoteliers","headers","Authorization","enterToken","token","withCredentials","data","uniqueOwners","Set","result","forEach","_ref2","finances","status","yourObjects","_id","has","add","push","error","fetchHotelsById","id","_ref3","fetch","hotels","credentials","ok","Error","json","hotelsByHotelier","map","_ref4","objectName","ownerId","fetchBonus","bonusData","_ref5","patch","bonus"],"sources":["D:/ad/adminka/src/features/hoteliers/hoteliersOperation.ts"],"sourcesContent":["import type {\n  DataHotels,\n  HotelierFetch,\n  DataHoteliers,\n  HotelFetch,\n  HotelsObjects,\n  ResponseData,\n  DataBonus,\n} from 'types/apis';\nimport { createAsyncThunk } from '@reduxjs/toolkit';\nimport { baseUrl, endpoints } from 'features/api';\nimport axios from 'axios';\nimport type { RootState } from 'App/store';\n\nexport const fetchHoteliers = createAsyncThunk<HotelierFetch[]>(\n  'hoteliers/fetchAllHoteliers',\n  async (_, { rejectWithValue, getState }) => {\n    try {\n      const authToken = getState() as RootState;\n\n      const response = await axios.get(`${baseUrl}/acsess-to-admin${endpoints.hoteliers}`, {\n        headers: {\n          'Content-Type': 'application/json; charset=UTF-8',\n          // eslint-disable-next-line\n          Authorization: `Bearer ${authToken.enterToken.token!}`,\n        },\n        withCredentials: true,\n      });\n      const data = response.data as DataHoteliers;\n\n      const uniqueOwners = new Set<string>();\n             const hoteliers: HotelierFetch[] = [];\n\n             data.data.result.forEach(({ finances, status, yourObjects, _id }: HotelierFetch) => {\n               if (_id && !uniqueOwners.has(_id)) {\n                 uniqueOwners.add(_id);\n                 hoteliers.push({ _id, status, finances, yourObjects });\n               }\n             });\n\n      return hoteliers;\n    } catch (error) {\n      return rejectWithValue(error);\n    }\n  }\n);\n\nexport const fetchHotelsById = createAsyncThunk<HotelsObjects, string>(\n  'hoteliers/fetchHotelsById',\n  async (id: string, { rejectWithValue }) => {\n    try {\n      const response = await fetch(\n        `${baseUrl + endpoints.hotels}/get-hotels-by-id-hotelier/${id}`,\n        { credentials: 'include' }\n      );\n      if (!response.ok) {\n        throw new Error('Failed to fetch hotels');\n      }\n      const data = (await response.json()) as DataHotels;\n      const hotelsByHotelier: HotelFetch = data.data.result.map(({ objectName }) => objectName);\n      return { ownerId: id, hotels: hotelsByHotelier };\n    } catch (error) {\n      return rejectWithValue(error);\n    }\n  }\n);\n\nexport const fetchBonus = createAsyncThunk<ResponseData, DataBonus>(\n  'hoteliers/fetchBonus',\n  async (bonusData: DataBonus, { rejectWithValue, getState }) => {\n    try {\n      const authToken = getState() as RootState\n\n      const response = await axios.patch(\n        `${baseUrl}/acsess-to-admin${endpoints.bonus}`,\n        bonusData,\n        {\n          headers: {\n            'Content-Type': 'application/json; charset=UTF-8',\n            // eslint-disable-next-line\n            Authorization: `Bearer ${authToken.enterToken.token!}`,\n          },\n          withCredentials: true,\n        }\n      );\n      const data = response.data as ResponseData;\n\n      return data\n    } catch (error) {\n      return rejectWithValue(error);\n    }\n  }\n);\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}